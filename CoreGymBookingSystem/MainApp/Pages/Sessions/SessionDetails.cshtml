@page "{id:int}"
@model MainApp.Pages.Sessions.SessionDetailsModel
@{
    Layout = "_GymLayout";
    ViewData["Title"] = Model.Session.Title;
}
<section class="class-details-section spad">
    <div class="container">
        <div class="row">
            <div class="col-lg-8">
                <div class="class-details-text">
                    <div class="cd-pic">
                        <img src="/Gym_Tem/img/classes/class-details/class-detailsl.jpg" alt="">
                    </div>
                    <div class="cd-text">
                        <div class="cd-single-item">
                            <h3>@Model.Session.Title</h3>
                            <p>Our @Model.Session.Title class is designed to help you reconnect with your body and mind...</p>
                        </div>
                        <div class="cd-single-item">
                            <h3>Trainer</h3>
                            <p>
                                <strong>@Model.Session.Instructor?.UserName</strong><br />
                                @Model.Session.Instructor?.Email
                            </p>
                        </div>
                        <div class="cd-single-item">
                            <h3>Session Info</h3>
                            <p>
                                <i class="fa fa-clock-o"></i>
                                @Model.Session.StartTime.ToString("yyyy-MM-dd HH:mm") - @Model.Session.EndTime.ToString("HH:mm")<br />
                                <i class="fa fa-users"></i>
                                Booked: <strong>@Model.Session.Bookings.Count</strong> / @Model.Session.MaxParticipants
                            </p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        @if (!string.IsNullOrEmpty(Model.StatusMessage))
        {
            <div style="text-align: center; margin-top: 30px;">
                <div style="display: inline-block; padding: 15px 25px; background-color: #f36100; color: white; border-radius: 5px; font-weight: 500;">
                    <span style="margin-left: 10px;">@Model.StatusMessage</span>
                </div>
            </div>
        }
        <div class="session-actions text-center mt-5">
            <a asp-page="/ClassDetails" class="btn-gym btn-back">Back to Classes</a>
            @if (Model.IsMember)
            {
                var isFull = Model.Session.Bookings.Count >= Model.Session.MaxParticipants;

                @if (Model.IsBooked)
                {
                    <form asp-page-handler="Cancel" asp-route-id="@Model.Session.Id" method="post" class="d-inline">
                        <button type="submit" class="btn-gym btn-cancel">Cancel Booking</button>
                    </form>
                }
                else if (!isFull)
                {
                    <form asp-page-handler="Book" asp-route-id="@Model.Session.Id" method="post" class="d-inline">
                        <button type="submit" class="btn-gym btn-book">Book This Session</button>
                    </form>
                }
                else
                {
                    <span class="btn-gym btn-full" style="opacity: 0.6; cursor: not-allowed;">Session Full</span>
                }
            }
            else
            {
                <a asp-page="/Account/Login" class="btn-gym btn-login">Log in to Book</a>
            }
        </div>

    </div>
</section>
